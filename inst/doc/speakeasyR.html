<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>speakeasyR</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">speakeasyR</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(Matrix)</span></code></pre></div>
<p>The SpeakEasy 2: Champagne (SE2) community detection algorithm groups
together graph nodes into communities based on their connectivity. The
detection algorithm works on weighted or unweighted graphs and directed
or undirected graphs.</p>
<p>This <strong>speakeasyR</strong> package provides a convenient way to
run the SE2 algorithm in R using the <code>cluster()</code> function.
The <code>cluster()</code> function accepts graphs in the form of
adjacency matrices (both base R matrices and <strong>Matrix</strong>
sparse matrices), <strong>igraph</strong> graphs, or anything that can
be coerced into an adjacency matrix using an <code>as.matrix()</code>
generic function.</p>
<div id="a-simple-example" class="section level2">
<h2>A simple example</h2>
<p>Before getting started, we will create a wrapper function that
returns a randomly generated <strong>igraph</strong> graph with clear
community structure. This function accepts number of nodes, number of
communities (or types), and a mixing parameter. The graph starts as a
regular block adjacency matrix—where each community is fully connected
within the community and has no edges leaving the community. It then
uses the mixing parameter (<code>mu</code>) to determine what proportion
of intracommunity edges should be rewired to connect nodes between
communities, the larger the mixing parameter, the weaker the community
structure.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>igraph_from_mixing_param <span class="ot">&lt;-</span> <span class="cf">function</span>(n_nodes, n_types, mu) {</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  pref <span class="ot">&lt;-</span> <span class="fu">matrix</span>(mu, n_types, n_types)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="fu">diag</span>(pref) <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> mu</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  igraph<span class="sc">::</span><span class="fu">sample_pref</span>(n_nodes, <span class="at">types =</span> n_types, <span class="at">pref.matrix =</span> pref)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>}</span></code></pre></div>
<p>With this function, a small, easy to cluster graph can be
created.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;igraph&quot;</span>)) {</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">igraph_from_mixing_param</span>(<span class="at">n_nodes =</span> <span class="dv">50</span>, <span class="at">n_types =</span> <span class="dv">5</span>, <span class="at">mu =</span> <span class="fl">0.1</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>}</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; Loading required namespace: igraph</span></span></code></pre></div>
<p>The graph can be clustered by calling <code>cluster</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;igraph&quot;</span>)) {</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  memb <span class="ot">&lt;-</span> speakeasyR<span class="sc">::</span><span class="fu">cluster</span>(g, <span class="at">seed =</span> <span class="dv">222</span>, <span class="at">max_threads =</span> <span class="dv">2</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>}</span></code></pre></div>
<p>The membership vector returned contains the community ids for each
vector, such that <code>memb[vid]</code> is the community id of vertex
<code>vid</code>. The seed argument is given to ensure reproducible
results.</p>
<p>The graph can be visualized using a heatmap to display the edges. To
view the detected communities, the nodes need to be reordered to group
members of the same community together. For this the
<code>order_nodes()</code> function is used.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;igraph&quot;</span>)) {</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  ordering <span class="ot">&lt;-</span> speakeasyR<span class="sc">::</span><span class="fu">order_nodes</span>(g, memb)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  adj <span class="ot">&lt;-</span> <span class="fu">as</span>(g[], <span class="st">&quot;matrix&quot;</span>)[ordering, ordering]</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  color <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(<span class="fu">unique</span>(memb)))[memb[ordering]]</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="fu">heatmap</span>(adj, <span class="at">scale =</span> <span class="st">&quot;none&quot;</span>, <span class="at">Rowv =</span> <span class="cn">NA</span>, <span class="at">Colv =</span> <span class="cn">NA</span>, <span class="at">RowSideColors =</span> color)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The graph is converted to an adjacency matrix to simplify indexing
and working with <code>heatmap()</code>. The color bar shows which nodes
each community encompasses.</p>
</div>
<div id="a-slightly-harder-example" class="section level2">
<h2>A slightly harder example</h2>
<p>SE2 can easily recover the community structure of a graph with little
crosstalk between communities, but how about in a larger graph with more
mixing?</p>
<p>Using the same wrapper function as before, we can generate and
cluster a tougher graph:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;igraph&quot;</span>)) {</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">igraph_from_mixing_param</span>(<span class="at">n_nodes =</span> <span class="dv">1000</span>, <span class="at">n_types =</span> <span class="dv">10</span>, <span class="at">mu =</span> <span class="fl">0.4</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  memb <span class="ot">&lt;-</span> speakeasyR<span class="sc">::</span><span class="fu">cluster</span>(g, <span class="at">seed =</span> <span class="dv">222</span>, <span class="at">max_threads =</span> <span class="dv">2</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  ordering <span class="ot">&lt;-</span> speakeasyR<span class="sc">::</span><span class="fu">order_nodes</span>(g, memb)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  adj <span class="ot">&lt;-</span> <span class="fu">as</span>(g[], <span class="st">&quot;matrix&quot;</span>)[ordering, ordering]</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  color <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(<span class="fu">unique</span>(memb)))[memb[ordering]]</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="fu">heatmap</span>(adj, <span class="at">scale =</span> <span class="st">&quot;none&quot;</span>, <span class="at">Rowv =</span> <span class="cn">NA</span>, <span class="at">Colv =</span> <span class="cn">NA</span>, <span class="at">RowSideColors =</span> color)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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JmMO0IzxcwPQUm5UR+PnBqCljjlAM8YcoBnjNADde9nP9jXN27vu3XysOXH06B0/bpqDzRdG31yz79n1zzTNFU+Mznr7xvsua498c/WaQ03zztY1u3Sz852Fl59tT9vz4MXPNc2Pjz72yInm1Vefv/TZpnn26Ztuapo7vzI+7ZH9G+5rr9zxyR0n2wUu2vRHCmD7LU0bwMt33tSuGQH85PIHmuath/ZvfqtpPnUUAew9b2O7+cradfc2OYBJAoMC9PBfWFg40DSbX79ifdPc+NRvHNnZvPZnN3zoy20beO2We77XHNp9zckt7ca+Tfe929zw3bN+2GZ7xff2fqpprn2yefbOpjnngoW2YVx+YtXvH2ievv3Xj1/dNL/1wc98/NXmwIErT1zTXvmD2/Y+2yw8uen2HzXN+vNfvqJpbnv1usdubJqzT5zY3DSf//sLCy82T++9/6ttAJffvevu7ymAO17a2jSfO7z1h19omtU7r/xW0wXw0p23P3tRi9nbzRe/3xz+tYWFXRHAJIFBAWp+Z/y89bHf+3NN8+gXT+14pGl+du3op6wuX7dp64+bdy75ixffO2qap77+/ebx885Z9YftkU8/elnTfHv1uotfaun0yuj6L+/9/q8daH564akHRr+n4eBvtpgf+swvH2o3/sUVf37de6Om+8w3m+bq8z4xunLVxq882jSXbdjYwvTTr42u/9ln3rzh7zbNlx458fG3I4BzPnZgbcvAS3557fOjAI7f3XQBvPPJc/7oSy3OG9df8l4kMAmgS2BQgCbjG/evvX9M501vjRi8cDRI2wnlpd23fH584uj3tx89csdR0X0yRqp6tzm05cTo+CtrL76nCb1NJNap6t7L3mmFdPDUgSuOhVK9zPfGy+wYz/fWaJmjo2U6cU702Epo07GQfScxL3NqtMz1S/lnxNkArT//hc1B547BE9J2Qtn8O7f8s2dCjx8590PXBd07iXWq2rNl9C1dE+53eptIrFPVRMkLzeYffyGUusgynWomy3TinOhxIqFO9qdfZgUA2vTK86Jzx+AJaTuh3H3eb37inaBzc9cvNUH3TmITVR040Bz53eB+p7eJxDpVTZR8x4azfu/hUOqsZTpxTvQ4kVAn+9MvswIATbQza+ePNjw06jX3XnZ033jj1L6xOA+M2s+O0Yejs4u1vehLP46Nnx45esdPx43p/lF/HEvs4NujLjXRRqeaiR5bpY5W+9TRt5pe/2tlvbGd846HFp5uJbbp0yOJ7T1vw9HYeOf6sZJXBKCpMWkvHd0nGze8eeVr60Mo3cZEnJP2k7pY14smG1//M9s+dDAaUyexbmOsjWiW441OqZPGlfrfRNZP7/71E+0y17y147qnwxAmGysnsUXGpL10dJ9sPHHFu+vWh1C6jYk4J+0ndbGuF3Ubhze1MHaNqZPYZGOijU41k41OqZPGlfrfRNbHz/vYZ1sPuPPiL115LAxhsrGSEvu/HRPVvYeNUzwweX7n3fGXt7Bx6u1BFuYyp6YPL2oUZzTmtxozxhygGWMO0IwxB2jGmAM0Y8wBmjHmAM0Yc4BmjDlAM8YcoBljDtCMMQdoxpgDNGPMAZox5gDNGHOAZow5QDPGHKAZYw7QjDEHaMaYAzRjzAGaMeYAzRhzgGaMOUAzxhygGWMO0IwxB2jGmAM0Y8wBmjHmAM0Yc4BmjDlAM8YcoBljDtCMMQdoxpgDNGPMAZox5gDNGHOAZow5QDPGHKAZYw7QjDEHaMaYAzRjzAGaMeYAzRhzgGaMOUAzxhygGWMO0IwxB2jGmAM0Y8wBmjH+DxorJndWlENrAAAAAElFTkSuQmCC" /><!-- --></p>
<p>Even with 40% of each community’s edges rewired to other communities,
the original membership is still closely recovered.</p>
</div>
<div id="tweaking-the-algorithm" class="section level2">
<h2>Tweaking the algorithm</h2>
<p>Out of the box, SE2 should work well. But one of the main goals of
SE2 is to ensure consistent results. Some more challenging graphs may
need extra runs to get past the variance and converge on a stable
community structure.</p>
<p>SE2 works by running the same core clustering algorithm multiple
times independently, starting with different initial guesses, and then
looking for stable patterns across runs to come to conclusions about
community structure. By default it performs 10
<code>independent_runs</code>, in many cases this is more than enough,
but if multiple calls to <code>cluster()</code> return significantly
different membership vectors, it’s worth increasing the number of runs
by setting the <code>independent_runs</code> parameter to a larger
value. The <code>target_partitions</code> and
<code>discard_transient</code> parameters may also help produce a more
robust result.</p>
<p>Each independent run tracks multiple possible partitions throughout
the run. The run ends when it has found <code>target_partitions</code>
number of partitions. In cases where there isn’t a clear structure to
converge on, increasing this parameter can provide more examples of
where the nodes naturally group.</p>
<p>If the graph is particularly noisy, it may take a longer time to find
useful communities. The <code>discard_transient</code> allows you to
adjust how many partitions to discard before the run starts tracking
partitions. By discarding a higher number of initial partitions, you
give SE2 more time to generate a sound foundation, giving less influence
to earlier, weaker communities structures in determining the final
membership vector.</p>
</div>
<div id="other-options" class="section level2">
<h2>Other options</h2>
<p>SE2 also has a few options that don’t impact how it clusters the
graph. These are <code>seed</code>, <code>verbose</code>, and
<code>max_threads</code>. The <code>seed</code> parameter was mentioned
above and sets the seed of the RNG used by SE2. While SE2 uses a random
number generator (RNG) different from R’s, the default value of the seed
is generated using R’s RNG. Because of this it’s possible to ensure
reproducible results over multiple SE2 calls by setting the R RNG seed
instead of setting the <code>cluster()</code> parameter.</p>
<p>Setting <code>verbose</code> to <code>TRUE</code> will cause SE2 to
print some information about clustering while it runs. This can be used
to ensure SE2 identifies the graph as expected but is more useful to
give information about the status of clustering during longer runs.
Lastly, <code>max_threads</code> provides the maximum number of threads
to run in parallel. SE2, can run each independent run in a separate
thread, each of which can be run on separate processing cores. By
default, SE2 will use as many threads as cores available but this can be
reduced if desired.</p>
</div>
<div id="cell-type-clustering-a-real-world-example" class="section level2">
<h2>Cell type clustering: a real world example</h2>
<p>Using publicly available single-cell RNA sequencing (scRNAseq) data,
we can test out SE2 on a real world example and attempt to cluster
individual cells into cell types based on the similarity of their gene
expression.</p>
<p>We will use the <code>scRNAseq</code> package to obtain a clean data
set:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;scRNAseq&quot;</span>) <span class="sc">&amp;&amp;</span> <span class="fu">requireNamespace</span>(<span class="st">&quot;SummarizedExperiment&quot;</span>)) {</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  expression <span class="ot">&lt;-</span> scRNAseq<span class="sc">::</span><span class="fu">FletcherOlfactoryData</span>()</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> SummarizedExperiment<span class="sc">::</span><span class="fu">assay</span>(expression, <span class="st">&quot;counts&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  cell_types <span class="ot">&lt;-</span> expression<span class="sc">$</span>cluster_id</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>}</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; Loading required namespace: scRNAseq</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; see ?scRNAseq and browseVignettes(&#39;scRNAseq&#39;) for documentation</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; loading from cache</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; see ?scRNAseq and browseVignettes(&#39;scRNAseq&#39;) for documentation</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; loading from cache</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; see ?scRNAseq and browseVignettes(&#39;scRNAseq&#39;) for documentation</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; loading from cache</span></span></code></pre></div>
<p>The <code>cell_types</code> above are the published cell types
identified through a non-graph based classification method. It’s
important to note that there is no “correct” answer to this
classification problem, so differences in results does not imply one
method is incorrect.</p>
<p>Since single-cell data is noisy due to the small amounts of gene
expression on an individual cell level and hard to correct for
differences in cell size, the <code>counts</code> must be filtered and
normalized before continuing. We start by removing any genes that are
expressed too little across the data set:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;scRNAseq&quot;</span>) <span class="sc">&amp;&amp;</span> <span class="fu">requireNamespace</span>(<span class="st">&quot;SummarizedExperiment&quot;</span>)) {</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  indices <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(counts <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">&gt;</span> <span class="dv">10</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> counts[indices, ]</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>}</span></code></pre></div>
<p>Any genes that have recorded counts in less than 10 cells are
discarded. We then use a simple normalization technique, shifted
logarithm on the counts matrix:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;scRNAseq&quot;</span>) <span class="sc">&amp;&amp;</span> <span class="fu">requireNamespace</span>(<span class="st">&quot;SummarizedExperiment&quot;</span>)) {</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  target <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">colSums</span>(counts))</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  size_factors <span class="ot">&lt;-</span> <span class="fu">colSums</span>(counts) <span class="sc">/</span> target</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  counts_norm <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">t</span>(<span class="fu">t</span>(counts) <span class="sc">/</span> size_factors <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>}</span></code></pre></div>
<p>Lastly, to further reduce noise, we use PCA to create 50 composite
features made by combining the gene expression from different sets of
genes:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;scRNAseq&quot;</span>) <span class="sc">&amp;&amp;</span> <span class="fu">requireNamespace</span>(<span class="st">&quot;SummarizedExperiment&quot;</span>)) {</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  counts_norm <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">prcomp</span>(<span class="fu">t</span>(counts_norm), <span class="at">scale. =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>x)[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, ]</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>}</span></code></pre></div>
<p>Now that we have preprocessed the data, it’s possible to convert it
to a similarity based graph. We will use the 50 PCA components to
determine how similar the gene expression between each of the cells are
and use this to create a k-nearest neighbors (kNN) graph. That is a
directed graph where each cell has <code>k</code> unweighted edges
leaving it going to the <code>k</code> most similar cells. Luckily, the
<strong>speakeasyR</strong> package provides a function to create this
graph:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;scRNAseq&quot;</span>) <span class="sc">&amp;&amp;</span> <span class="fu">requireNamespace</span>(<span class="st">&quot;SummarizedExperiment&quot;</span>)) {</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  adj <span class="ot">&lt;-</span> speakeasyR<span class="sc">::</span><span class="fu">knn_graph</span>(counts_norm, <span class="dv">10</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>}</span></code></pre></div>
<p>This graph can be passed to SE2 and visualized using a heatmap as
before:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;scRNAseq&quot;</span>) <span class="sc">&amp;&amp;</span> <span class="fu">requireNamespace</span>(<span class="st">&quot;SummarizedExperiment&quot;</span>)) {</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  memb <span class="ot">&lt;-</span> speakeasyR<span class="sc">::</span><span class="fu">cluster</span>(adj, <span class="at">verbose =</span> <span class="cn">TRUE</span>, <span class="at">seed =</span> <span class="dv">222</span>, <span class="at">max_threads =</span> <span class="dv">2</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  ordering <span class="ot">&lt;-</span> speakeasyR<span class="sc">::</span><span class="fu">order_nodes</span>(adj, memb)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>}</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; Approximate edge density is 0.0162338.</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; Input type treated as unweighted.</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; Graph is asymmetric.</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; Calling main routine at level 1.</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; Completed generating initial labels.</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; Produced 37 seed labels, while goal was 10.</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; Starting level 1 clustering; independent runs might not be displayed in order - that is okay...</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; Starting independent run #1 of 10</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; Starting independent run #2 of 10</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; Starting independent run #3 of 10</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; Starting independent run #4 of 10</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; Starting independent run #6 of 10</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; Starting independent run #5 of 10</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; Starting independent run #8 of 10</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt; Starting independent run #7 of 10</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt; Starting independent run #10 of 10</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt; Starting independent run #9 of 10</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co">#&gt; Generated 50 partitions at level 1.</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co">#&gt; Mean of all NMIs is 0.87654.</span></span></code></pre></div>
<p>The kNN graph is initially in a sparse matrix form, this is converted
to a base <code>matrix</code> type to make it easier to reorder the
nodes.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;scRNAseq&quot;</span>) <span class="sc">&amp;&amp;</span> <span class="fu">requireNamespace</span>(<span class="st">&quot;SummarizedExperiment&quot;</span>)) {</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  adj <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as</span>(adj, <span class="st">&quot;dMatrix&quot;</span>))</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  row_colors <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(<span class="fu">unique</span>(cell_types)))[cell_types[ordering]]</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  col_colors <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(<span class="fu">unique</span>(memb)))[memb[ordering]]</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="fu">heatmap</span>(</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>    adj[ordering, ordering],</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    <span class="at">Colv =</span> <span class="cn">NA</span>, <span class="at">Rowv =</span> <span class="cn">NA</span>,</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>    <span class="at">labRow =</span> <span class="cn">NA</span>, <span class="at">labCol =</span> <span class="cn">NA</span>,</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>    <span class="at">RowSideColors =</span> row_colors, <span class="at">ColSideColors =</span> col_colors,</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;SE2 Cluster&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Cell Type&quot;</span>,</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>    <span class="at">scale =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>  )</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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e/bsWbJkycyZM1evXn316tWOfiszM3Ps2LE7d+709PRsampKS0sbPnz45cuX2aONjY0FBQV37txx+F7i4+MPHTrk8OmIi2C0RGBg4MSJE9va2th/7927l5KS4uXl1dTUxIZERETMmzdP4gopKSlubm5Llix55ZVXgoKC+vbt++233wqj7dq1S6fTbdq0yRpSU1Pj7+8fFRXF/nvhwgUA+O677xy+Fz8/v3feecfh0xHXoCGB3bhxAwDef/99bmBxcfHgwYOtIpEW2MWLFwEgOzub/bepqSkkJGT69Om8aG1tbUOHDp09ezYv3GKxAEBpaSlzv8BKSkri4uJ+/PFHa8zExMT8/Hz2e2Vl5apVq6ZNm/bss89+/PHHDMO0trbGxcW5u7sPGzbMaDSy0Y4dO2Y2m6dPn75u3Trrpa5evRoXF3flypXExMRRo0bZn1eIs9CQiejh4eHm5paXl8c1zMLDwysrK0NDQ+25QlFREQAkJCSw//bu3XvChAmsVLicP3/+8uXLL7zwAi88KSmptrbW39+fF15fX19QUNDS0mIN+eqrr6qrqwGgurp69OjRn3zyyfDhw3/44YdZs2bl5+f37Nnz+eef79OnT3R09Lx58wAgIyNj+vTpt27dGjZsmMVieeyxx+rq6gCgqampoKAgKSmppKTk6aeftuceESejtMJdytq1awGgf//+zz777K5du2pqangRIiIiHnjggTgBra2tDMM0NjbW1tZaI7e0tAQFBU2dOpV3EbZTV11dLZESbgv21VdfAQA3MYMHD968eTPDMNu2bdPr9dYWadKkSS+++CL73WoiVlZW6vX6Dz74gA2vra318fF56aWXGIZhHTYzZsy4e/duV/MKcQra8iKmp6dPmjRp3759J0+e/NOf/gQAY8aMycjImDRpkjVOv379hA2aTqcDAE9PT09PTzakpqZmwYIF165d279/Py8y23oMGDCg+wn29PRsbW3dv3+/0Wj08PD49NNPhXGOHDni7u5uMpnYfw0Gw/z580+dOmWNYDKZevbs2f3EIA6gLYEBwPjx48ePHw8AV65cKSws/PDDD6dOnfr5559HR0ezER599NFt27ZJXKGpqWn9+vVbt24dNWpUYWFhWFgYL0JAQAAAfP/999wBAJaioqKBAwf6+fnZmdqFCxd++umny5cvf/XVV6OiombPnm00Gt3d3blxysvLW1tbw8PDrSFsi2f9d9CgQXb+HOJ0NCSwAwcObNiw4dy5c2x1HhAQEBAQkJCQ8PDDD+/evdsqMGkuXbo0ffp0ANizZ8+cOXPYlo3HiBEjAOD06dM8gZWVlY0ePXrHjh1Go1H6V+rr69kver0+Ly9v8+bNx44dO378+IoVKw4fPvy3v/2NG9nd3d1gMGRlZXEDuU1Wr1697Lk1RA405OQYNGhQcXHxyZMnuYEMwzQ3N/fv39+eKzQ0NDz55JMRERHffvvt3LlzRdUFACEhIU899dT69eutOmHZsWOHTqf77W9/K3oW6+QEgIqKips3b7Lfd+7cuXXrVj8/P7PZfPjw4czMzFOnTjU2NvJ+rq6uLiwsLPYXrly5IjFAh7gSDQksOjo6NjZ24cKF27dvv3TpUm1t7ZkzZ+bMmdPa2rpw4UJrtNbW1lsCmpubAWDv3r21tbWrVq26evVqxS98//33wt/atGlTfX19ZGTkwYMHq6qqLl68uG7duszMzFWrVg0ZMoQXmZ3MkZmZ+dNPP/3zn/9kPYTsoZqamtWrVx89evTOnTtlZWWfffaZv7+/9Sirw4SEhAEDBixevLimpub27ds5OTnPPfdcW1ubDFmIdB2lvSwu5fr168nJyVzzaezYsQUFBdYIERERorn08ssvMwyTnJwsPBQcHCz6W1VVVU8++aRer2ejeXp6pqWltbS0sEd5A81r1qzp0aOHXq93d3d/99134+LiWC/i7du32RaPbS2HDRv2xRdfsKewlUJMTAzDMEVFRcHBwWw0Dw+P9PR0Ng7rRSwuLpYlNxE70DGc3jCCIM5FQyYigrgeFBiCyAgKDEFkBAWGIDKCAkMQGfl/72NIp2FtSvwAAAAASUVORK5CYII=" /><!-- --></p>
<p>Here the color bar on the x-axis shows the communities based on SE2
while the y-axis color bar displays the communities the publication
found. Ordering is based on the SE2 results so there is some mixing of
the previous cell types communities but not of SE2 in the visual.</p>
</div>
<div id="hierarchical-clustering" class="section level2">
<h2>Hierarchical clustering</h2>
<p>Real networks often have hierarchical structures, within a friend
clique there can be smaller groups of closer friendships, or in the
publication landscape, collaboration is likely to be common between
members of the same lab but there can also be collaboration at a higher
scale between labs and between universities or even fields.</p>
<p>SE2 provides subclustering where the individual communities of the
initial clustering will in turn be clustered into smaller communities.
This behavior can be turned on by setting the <code>subclusters</code>
to parameter to a value greater than 1. (The <code>min_clust</code>
parameter determines the smallest community to consider for
subclustering, if a community has fewer than <code>min_clust</code>
nodes, it will not be subclustered further.)</p>
<p>We can use this subclustering feature to cluster the cell types in
the previous example into subtypes.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;scRNAseq&quot;</span>) <span class="sc">&amp;&amp;</span> <span class="fu">requireNamespace</span>(<span class="st">&quot;SummarizedExperiment&quot;</span>)) {</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  memb <span class="ot">&lt;-</span> speakeasyR<span class="sc">::</span><span class="fu">cluster</span>(</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>     adj,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>     <span class="at">subcluster =</span> <span class="dv">2</span>,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>     <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>     <span class="at">seed =</span> <span class="dv">222</span>,</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>     <span class="at">max_threads =</span> <span class="dv">2</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  )</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  ordering <span class="ot">&lt;-</span> speakeasyR<span class="sc">::</span><span class="fu">order_nodes</span>(adj, memb)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>}</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; Approximate edge density is 0.0162338.</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; Input type treated as unweighted.</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt; Graph is asymmetric.</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt; Calling main routine at level 1.</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt; Starting independent run #1 of 10</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt; Starting independent run #2 of 10</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt; Starting independent run #3 of 10</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; Starting independent run #4 of 10</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; Starting independent run #5 of 10</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; Starting independent run #6 of 10</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; Starting independent run #7 of 10</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; Starting independent run #8 of 10</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt; Starting independent run #9 of 10</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt; Starting independent run #10 of 10</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt; Generated 50 partitions at level 1.</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="co">#&gt; Mean of all NMIs is 0.89678.</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt; Subclustering at level 2.</span></span></code></pre></div>
<p><code>memb</code> is now a matrix with one row per level of
subclustering instead of a vector. Similarly, there are two sets of
order indices in <code>ordering</code>, one in row 1 and the second in
row 2. The <code>order_nodes()</code> function recursively orders nodes
by community. So each community in the previous level is reordered
rather than completely reordering all nodes based only on the second
level of clustering. This leaves some remnants of previous levels’
ordering in the resulting heatmaps.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;scRNAseq&quot;</span>) <span class="sc">&amp;&amp;</span> <span class="fu">requireNamespace</span>(<span class="st">&quot;SummarizedExperiment&quot;</span>)) {</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  level <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  level_order <span class="ot">&lt;-</span> ordering[level, ]</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  level_memb <span class="ot">&lt;-</span> memb[level, level_order]</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  row_colors <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(<span class="fu">unique</span>(cell_types)))[cell_types[level_order]]</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  col_colors <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(<span class="fu">unique</span>(level_memb)))[level_memb]</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="fu">heatmap</span>(</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>    adj[level_order, level_order],</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>    <span class="at">Colv =</span> <span class="cn">NA</span>, <span class="at">Rowv =</span> <span class="cn">NA</span>,</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>    <span class="at">labRow =</span> <span class="cn">NA</span>, <span class="at">labCol =</span> <span class="cn">NA</span>,</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>    <span class="at">RowSideColors =</span> row_colors, <span class="at">ColSideColors =</span> col_colors,</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;SE2 Cluster&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Cell Type&quot;</span>,</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>    <span class="at">scale =</span> <span class="st">&quot;none&quot;</span>, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Level &quot;</span>, level, <span class="st">&quot;structure&quot;</span>)</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>  )</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here the original communities have been further broken down into
groups of cells that are particularly similar within cell types. When
comparing this heatmap to the previous heatmap, notice some of the
communities at level 1 combine multiple of the publication’s communities
but at level 2, they are separated out into distinct cell types.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
